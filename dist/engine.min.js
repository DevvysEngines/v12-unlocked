class e{constructor(){this.canvas=document.createElement("canvas"),this.canvas.style.position="fixed",this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,this.canvas.style.left=0,this.canvas.style.top=0,this.ctx=this.canvas.getContext("2d"),this.ctx.textAlign="center",document.body.insertBefore(this.canvas,document.body.childNodes[0])}}function t(e){return Math.PI/180*e}var s=Object.freeze({__proto__:null,distance:function(e,t,s,i){return Math.sqrt((s-e)*(s-e)+(i-t)*(i-t))},rotatepoint:function(e=0,s=0,i=0,n=0,r=0){i=t(i),s-=r;let o={x:(e-=n)*Math.cos(i)-s*Math.sin(i),y:e*Math.sin(i)+s*Math.cos(i)};return o.x+=n,o.y+=r,o},toradians:t,tosec:function(e){return e/1e3*60}}),i=Object.freeze({__proto__:null,aroundChunk:function(e=()=>{},t,s,i){const n=J.currentscene.camera;t=t??n.chunk.x,s=s??n.chunk.y;for(let r=(i=i??n.show).width;r>=-i.width;r--)for(let n=i.height;n>=-i.height;n--)J.currentscene.ifChunk(t-r,s-n)&&e({chunk:J.currentscene.giveChunk(t-r,s-n),i:r,v:n,game:J})},tomap:function(e,t){const s=J.currentscene.camera,i=J.window;return{x:(e-s.x)/s.zoom+i.width/2,y:(t-s.y)/s.zoom+i.height/2}},unmap:function(e,t){const s=J.currentscene.camera,i=J.window;return{x:e*s.zoom-i.width/2*s.zoom+s.x,y:t*s.zoom-i.height/2*s.zoom+s.y}}}),n=Object.freeze({__proto__:null,normalizePath:function(e){let t=[];return Array.isArray(e)||(e=[e]),e.forEach(e=>{"string"==typeof e?(e=e.split(/[.\[\]\/]+/).filter(e=>e.length),t.push(...e)):t.push(e)}),[...t]}});const r={...s,...Object.freeze({__proto__:null,giveColorWithTables:function(e,t){return`${e[0]},${e[1]},${e[2]},${t}`},givefont:function(e=16,t="sans-serif",s=""){return`${t} ${e}px ${s}`},measureText:function(e,t){return J.ctx.font=utils.givefont(t.fontsize,t.fonttype,t.fontstyle),J.ctx.measureText(e).width}}),...i,...n};class o{constructor(){window.addEventListener("resize",o.resize),window.addEventListener("keydown",o.keyboard),window.addEventListener("mousemove",o.mousemove),window.addEventListener("mousedown",o.mousedown),window.addEventListener("mouseup",o.mouseup),window.addEventListener("contextmenu",o.preventRight)}static preventRight(e){e.preventDefault()}static resize(){J.canvas.width=J.window.width=window.innerWidth,J.window.height=J.canvas.height=window.innerHeight,J.ctx.textAlign="center"}static keyboard(e){switch(e.key){case"w":J.currentscene.camera.y-=5;break;case"a":J.currentscene.camera.x-=5;break;case"s":J.currentscene.camera.y+=5;break;case"d":J.currentscene.camera.x+=5;break;case"e":J.currentscene.camera.zoom+=1/4;break;case"q":J.currentscene.camera.zoom-=1/4}o.mousemove()}static mousemove(e=J.mouse){J.mouse.x=e.x,J.mouse.y=e.y;let t=!1;for(let s in Object.values(J.currentscene.uiList))s.ifover(e.x,e.y)?(s.set("mouse/over",!0),t=!0):1==s.get("mouse/over")&&s.set("mouse/over",!1);e=r.unmap(e.x,e.y),J.mouse.filteredX=e.x,J.mouse.filteredY=e.y,r.aroundChunk(s=>{Object.values(s.chunk.mouseElements).forEach(s=>{s.ifover(e.x,e.y)?(s.set("mouse/over",!0),t=!0):1==s.get("mouse/over")&&s.set("mouse/over",!1)})}),document.body.style.cursor=t?"pointer":"default",J.mouse.isover=t}static mousedown(e){let t=0==e.button?"left":1==e.button?"middle":"right";"middle"==t&&e.preventDefault();for(let s in Object.values(J.currentscene.uiList))s.ifover(e.x,e.y)&&(s.set(`mouse/${t}/down`,!0),s.set(`mouse/${t}/dragging`,!0));e=r.unmap(e.x,e.y),r.aroundChunk(s=>{Object.values(s.chunk.mouseElements).forEach(s=>{s.ifover(e.x,e.y)&&(s.set(`mouse/${t}/down`,!0),s.set(`mouse/${t}/dragging`,!0))})})}static mouseup(e){let t=0==e.button?"left":1==e.button?"middle":"right";"middle"==t&&e.preventDefault();for(let s in Object.values(J.currentscene.uiList))s.ifover(e.x,e.y)&&(s.ifover(e.x,e.y)&&1==s.get(`mouse/${t}/down`)?(s.set(`mouse/${t}/down`,!1),s.set(`mouse/${t}/dragging`,!1)):1==s.get(`mouse/${t}/down`)&&(s.system_set(["mouse",t,"down"],!1),s.set(`mouse/${t}/dragging`,!1)));e=r.unmap(e.x,e.y),r.aroundChunk(s=>{Object.values(s.chunk.mouseElements).forEach(s=>{s.ifover(e.x,e.y)&&1==s.get(`mouse/${t}/down`)?(s.set(`mouse/${t}/down`,!1),s.set(`mouse/${t}/dragging`,!1)):1==s.get(`mouse/${t}/down`)&&(s.system_set(["mouse",t,"down"],!1),s.set(`mouse/${t}/dragging`,!1))})})}}class a{constructor(e,t,s){this.pos={x:t,y:s},this.scene=e,this.x=this.pos.x*this.scene.chunkSize,this.y=this.pos.y*this.scene.chunkSize,this.mouseElements={},this.allElements={},this.elements={},this.renderChunk()}addElement(e){e.get("properties/usesMouse")&&(this.mouseElements[e.id]=e),e.set("properties/chunk",this.pos);const t=e.color,s=e.id;let i;this.allElements[s]=e,this.elements[t]||(this.elements[t]={}),i=this.elements[t],i[s]=e}removeElement(e){this.mouseElements[e.id]&&delete this.mouseElements[e.id],e.set("properties/chunk",{x:-1,y:-1});const t=e.color,s=e.id;let i;delete this.allElements[s],this.elements[t]&&(i=this.elements[t],delete i[s],Object.keys(i).length<=0&&delete this.elements[t])}update(e,t){Object.values(this.allElements).forEach(s=>{s.update(e,t)})}render(e){Object.keys(this.elements).forEach(t=>{e.fillStyle=`rgb(${t})`,e.beginPath(),Object.values(this.elements[t]).forEach(t=>{t.render(e),e.closePath()}),e.fill()})}renderChunk(e){}}class h{x=0;y=0;zoom=1;rotation=0;chunk={x:0,y:0};show={width:5,height:5};constructor(e){e.addCamera(this)}update(){const e=this.scene.game.currentscene.locateChunkByPos(this.x,this.y),t={x:e.pos.x,y:e.pos.y},s=this.chunk;t.x==s.x&&t.y==s.y||(this.chunk=t)}}class l{constructor(e){this.Name=e,this.game=J,this.chunks={},this.uiList={},this.chunkSize=600,this.addCamera(new h(this))}ifChunk(e=0,t=0){if(window.chunk=this,this.chunks[`${e}`]&&this.chunks[`${e}`][`${t}`])return!0}moveElementToChunk(e,t){e.chunk.removeElement(e),t.addElement(e)}giveChunk(e,t){return this.ifChunk(e,t)||this.insertChunk(e,t),this.chunks[`${e}`][`${t}`]}insertChunk(e,t){this.ifChunk(e,t),this.chunks[`${e}`]={},this.chunks[`${e}`][`${t}`]=new a(this,e,t)}locateChunkByPos(e,t){const s=Math.floor(e/this.chunkSize),i=Math.floor(t/this.chunkSize);return this.giveChunk(s,i)}addElement(e){if(e.get("properties/ui"))return void e.setToUi();const t=this.locateChunkByPos(e.x,e.y);t&&t.addElement(e)}removeElement(e){e.chunk.removeElement(e)}addCamera(e){this.camera=e,e.scene=this}render(e){r.aroundChunk(t=>{t.chunk.render(e)})}update(e){const t=60*e/1e3;r.aroundChunk(s=>{s.chunk.update(e,t)})}}function c(e=0){J.time||(J.time=e);const t=e-J.time;J.time=e,J.ctx.clearRect(0,0,J.window.width,J.window.height),J.currentscene.update(t);for(let e in Object.values(J.currentscene.uiList))e.update(t,60*t/1e3);J.currentscene.render(J.ctx);for(let e in Object.values(J.currentscene.uiList))J.ctx.beginPath(),J.ctx.fillStyle=`rgb(${e.color})`,e.render(J.ctx),J.ctx.fill();requestAnimationFrame(c)}class u{static box={render:(e,t)=>{e.roundRect(-t.width/2,-t.height/2,t.width,t.height,0),e.closePath()},ifover(e,t,s){let{x:i,y:n}=r.rotatepoint(e,t,s.rotation,s.x,s.y);return i>s.x-s.width/2&&i<s.x+s.width/2&&n<s.y+s.height/2&&n>s.y-s.height/2}};static arc={render:(e,t)=>{e.arc(0,0,t.radius,0,2*Math.PI),e.closePath()},ifover:(e,t,s)=>r.distance(e,t,s.x,s.y)<s.radius};static txt={render:(e,t,s)=>{e.font=r.givefont(t.fontsize,s.fonttype,s.fontstyle),e.fillText(s.string,0,t.fontsize/4)},ifover:(e,t,s,i,n)=>u.box.ifover(e,t,s)}}let d={};class m{static generateId=function(e=28){let t="";for(let s=0;s<e-4;s++)t+="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890-=+_|!@#$%^&*()".charAt(Math.floor(77*Math.random()));d[t]&&(t=m.generateId(e));let s=Math.floor(Math.random()*(t.length+1));return t=t.slice(0,s)+"gen-"+t.slice(s),d[t]=!0,t};static normalize_path(...e){let t=[];return e.forEach(e=>{"string"==typeof e?t.push(...e.replaceAll(".","/").replaceAll("[","/").replaceAll("]","").split("/")):t.push(e)}),t}static system_signal_converter(e="/",t="set"){return`*v9$:$${t[0]}?{>${m.normalize_path(e).join(">")}}*`}static ctxUse(e,t,s){return(...i)=>{t.set_context(e);let n=e.proto[s].call(t,...i);t.remove_context(),"object"==typeof n&&Object.assign(e,n)}}}class g{#e=[];#t={scripts_storage:{},signals_storage:{}};get id(){return this.#t.id}get context(){return this.#e[this.#e.length-1]}set_context(e){return this.#e.push(e)}remove_context(){return this.#e.pop()}system_set(e=[],t=0){let s,i=this.#t;for(let t=0;t<e.length-1;t++)"object"!=typeof i[e[t]]&&(i[e[t]]={}),i=i[e[t]];return s=i[e[e.length-1]],i[e[e.length-1]]=t,[s,t,...e]}system_delete(e=[]){let t,s=this.#t;for(let t=0;t<e.length-1;t++){if("object"!=typeof s[e[t]])return[void 0,!1,...e];s=s[e[t]]}return t=s[e[e.length-1]],delete s[e[e.length-1]],[t,!0,...e]}system_get(e=[]){let t=this.#t;for(let s=0;s<e.length-1;s++){if("object"!=typeof t[e[s]])return;t=t[e[s]]}return t[e[e.length-1]]}set(...e){let t=e.pop(),s=m.normalize_path(...e),i=this.system_set(s,t);if(i[0]==t)return;let n="";this.emit("*v9$:$s?{>>}*",i),s.forEach(e=>{n+=`>${e}`,this.emit(`*v9$:$s?{${n}>}*`,i)}),this.emit(`*v9$:$s?{${n}}*`,i)}get(...e){return this.system_get(m.normalize_path(...e))}delete(...e){let t=m.normalize_path(...e),s=this.system_delete(t);if(!s[1])return;let i="";this.emit("*v9$:$d?{>>}*",s),t.forEach(e=>{i+=`>${e}`,this.emit(`*v9$:$d?{${i}>}*`,s)}),this.emit(`*v9$:$d?{${i}}`,s)}constructor(e,...t){Object.assign(this.#t,e,{scripts_storage:{},signals_storage:{},id:m.generateId()}),t.forEach(e=>{this.insert(...e)})}}let f=class extends(function(e){return class extends e{insert(e,...t){let s={id:m.generateId(),info:t,proto:e};return s.run=m.ctxUse(s,this,"fired"),this.set(`scripts_storage/${s.id}`,s),this.set(`signals_storage/${s.proto.signal}/${s.id}`,!0),s.id}remove(e=this.context){"string"==typeof e&&(e=this.script(e)),this.set()}script(e=this.context.id){return this.system_get(["scripts_storage",e])}emit(e,...t){let s=this.system_get(["signals_storage",e]);s&&Object.keys(s).forEach(e=>{let s=this.script(e);s.run(...t,...s.info)})}}}(g)){};const p={properties:{x:0,y:0,chunk:{x:0,y:0},ui:!1,inUi:!1},renderer:{type:"box",x:0,y:0,width:30,height:30,radius:15,string:"String",fonttype:"bold",fontstyle:"sans-serif",fontsize:20,roundedness:0,color:[0,0,0],rotation:0,transparency:1},hitbox:{type:"box",x:0,y:0,rotation:0,width:30,height:30,radius:15},reactions:{},reactionsList:{},nodes:{},mouse:{over:!1,left:{over:!1,dragging:!1},right:{over:!1,dragging:!1},middle:{over:!1,dragging:!1}}};class y extends f{update(...e){this.emit("-u$u",...e)}render(e){const t=this.dime;e.save(),e.translate(t.x,t.y);const s=this.system_get(["renderer"]);u[s.type].render(e,t,s),e.restore()}has(...e){return this.system_has(r.normalizePath(e))}system_has(e){return void 0!==this.system_get(e)}constructor(e={},t={},s={},...i){const n=structuredClone(p);if(n.properties={...n.properties,...e},n.renderer={...n.renderer,...t},n.hitbox={...n.hitbox,...s},super(n),i.length<1)return;let r=i.pop();"function"!=typeof r&&(i.push(r),r=!1),this.use(...i),r&&r.call(this)}}class v extends(function(e){return class extends e{use(...e){for(let t in e)Array.isArray(e[t])?this.insert(...e[t]):this.insert(e[t])}}}(function(e){return class extends e{get dime(){const e=this.system_get(["renderer"]),t=this.system_get(["properties"]);if(t.ui)return{x:Math.round(t.x+e.x),y:Math.round(t.y+e.y),width:Math.round(e.width),height:Math.round(e.height),radius:Math.round(e.radius),fontsize:e.fontsize,rotation:e.rotation};const s=J.currentscene.camera,i=r.tomap(t.x+e.x,t.y+e.y);return{x:Math.round(i.x),y:Math.round(i.y),width:Math.round(e.width/s.zoom),height:Math.round(e.height/s.zoom),radius:Math.round(e.radius/s.zoom),fontsize:e.fontsize/s.zoom,rotation:e.rotation}}get hitboxDime(){let e=this.system_get(["hitbox"]);return{x:this.x+e.x,y:this.y+e.y,type:e.type,width:e.width,height:e.height,radius:e.radius,rotation:e.rotation}}}}(function(e){return class extends e{get color(){const e=this.system_get(["renderer"]);return J.utils.giveColorWithTables(e.color,e.transparency)}get x(){return this.system_get(["properties","x"])}get y(){return this.system_get(["properties","y"])}get chunk(){let e=this.system_get(["properties"]).chunk;return J.currentscene.giveChunk(e.x,e.y)}}}(y)))){constructor(e,t,s,...i){super(e,t,s,...i)}}class x extends v{constructor(e,t,s,...i){super(e,t,s,...i)}setup(){let e;this.get("vitals")||this.set("vitals",{}),this.get("vitals/maxHealth")||this.set("vitals/maxHealth",100),this.get("vitals/health")||this.set("vitals/health",100),e=this.getHealthInfo,this.batchSet(["vitals/healthPercentage",e.health/e.maxHealth],["vitals/lastDamaged",null],["vitals/entitiesThatDamaged",new Map],["vitals/lastDamageDealtTo",null],["vitals/lastDamageDealtAmount",0],["vitals/entitiesKilled",0],["vitals/entitiesThatThisDamaged",new Map])}get health(){return this.get("vitals/health")}get healthPercentage(){return this.get("vitals/healthPercentage")}get getHealthInfo(){return{health:this.health,maxHealth:this.get("vitals/maxHealth"),healthPercentage:this.healthPercentage,lastDamaged:this.get("vitals/lastDamaged"),entitiesThatDamaged:this.get("vitals/entitiesThatDamaged")}}get getDamageInfo(){return{lastDamageDealtTo:this.get("vitals/lastDamageDealtTo"),lastDamageDealtAmount:this.get("vitals/lastDamageDealtAmount"),entitiesThatThisDamaged:this.get("vitals/entitiesThatThisDamaged"),entitiesKilled:this.get("vitals/entitiesKilled")}}Damage(e,t){if(!t)return;if(!t.isElement)return;const s=this.get("vitals/health"),i=t.id,n=this.id;this.set("vitals/health",s-e),this.set("vitals/lastDamaged",i);let r=this.getHealthInfo;if(this.set("vitals/healthPercentage",r.health/r.maxHealth),r.entitiesThatDamaged.has(i)){let s=r.entitiesThatDamaged,n=s.get(t.id);s.set(i,{id:i,times:n.times+1,totalDamage:n.totalDamage+e,lastDamage:e}),this.set("vitals/entitiesThatDamaged",s)}else r.entitiesThatDamaged.set(i,{id:i,times:1,totalDamage:e,lastDamage:e});t.set("vitals/lastDamageDealtTo",n),t.set("vitals/lastDamageDealtAmount",e);let o=t.getDamageInfo;if(o.entitiesThatThisDamaged.has(n)){let t=o.entitiesThatThisDamaged,s=o.entitiesThatThisDamaged.get(n);t.set(n,{id:n,times:s.times+1,totalDamage:s.totalDamage+e,lastDamage:e})}else o.entitiesThatThisDamaged.set(n,{id:n,times:1,totalDamage:e,lastDamage:e});e>=s&&(t.set("vitals/entitiesKilled",o.entitiesKilled+1),t.set("vitals/entitiesKilledAmount",o.entitiesKilledAmount+1),this.death())}dealDamage(e,t){t.Damage(e,this)}death(){this.destroy()}customdestroy(){const e=this.id;let t=this.get("vitals/entitiesThatThisDamaged"),s=this.get("vitals/entitiesThatDamaged");for(let[s,i]of t){let t=J.allElements[i.id],s=t.get("vitals/entitiesThatDamaged");s.delete(e),t.set("vitals/entitiesThatDamaged",s)}for(let[t,i]of s){let t=J.allElements.get(i.id),s=t.get("vitals/entitiesThatThisDamaged");s.delete(e),t.set("vitals/entitiesThatThisDamaged",s)}}customupdate(e){}}class w{#s={triggerTimes:0,active:!0,condition:function(){return!0},trigger:function(){return!0},Name:"eventNode",tags:[],path:["properties/health"],onApply:function(){},onFinished:function(){}};constructor(e,t,s,i,n,o,a,h){"object"!=typeof e&&(e={Name:e,tags:t,path:s,condition:i,trigger:n,triggerTimes:o,onApply:a,onFinished:h}),Object.assign(this,{...this.#s},Object.fromEntries(Object.entries(e).filter(([e,t])=>void 0!==t))),this.tags=r.normalizePath(this.tags),this.path=r.normalizePath(this.path),this.type="eventNode"}}let _=w;function b(e,[t,s]){let i=this.chunk;i&&(this.system_set(["renderer",e],t),i.removeElement(this),this.system_set(["renderer",e],s),i.addElement(this))}function k(e){let t=this.chunk;if(!t)return;let s=J.currentscene.locateChunkByPos(this.x,this.y);s&&t.pos[e]!=s.pos[e]&&J.currentscene.moveElementToChunk(this,s)}let $={element:[[new _("xPositionChange",["system/presets/x/position/change"],["properties/x"],void 0,function(){k.call(this,"x")})],[new _("yPositionChange",["system/presets/y/position/change"],["properties/y"],void 0,function(){k.call(this,"y")})],[new _("colorChange",["system/presets/color"],["renderer/color"],void 0,function(e){b.call(this,"color",e)})],[new _("transparencyChange",["system/presets/transparency"],["renderer/transparency"],void 0,function(e){b.call(this,"transparency",e)})],[new _("uiOn",["ui/system/on"],["properties/ui"],function(e,t){return t},function(){this.setToUi()})],[new _("uiOff",["ui/system/off"],["properties/ui"],function(e){return e},function(){this.removeFromUi()})],[new _("usesMouseChange",["system/input"],["properties/usesMouse"],void 0,function(){let e=this.chunk;e&&J.currentscene.moveElementToChunk(this,e)})]]};var D=Object.freeze({__proto__:null,system_presets:$});class E{#s={Name:"node",tags:[],onApply:function(){},update:function(){},onFinished:function(){},type:"node"};constructor(e,t,s,i,n){"object"!=typeof e&&(e={Name:e,tags:t,update:s,onApply:i,onFinished:n,type:"node"}),Object.assign(this,{...this.#s},Object.fromEntries(Object.entries(e).filter(([e,t])=>void 0!==t))),this.tags=r.normalizePath(this.tags),this.type="node"}}let z=w,T=["mouse"];function j(e){if(this.set("properties/usesMouse",!0),!e)return{info:[function(){}]}}function C(){this.searchForEventNodeByTag(T).length<=0&&this.set("properties/usesMouse",!1)}function M(e){return{Down:new z("mouseDown",[`mouse/presets/down/${e}`],[`mouse/${e}/down`],O,...P),Up:new z("mouseUp",[`mouse/presets/up/${e}`],[`mouse/${e}/down`],A,...P),Dragging:new z({path:[`mouse/${e}/dragging`],condition:O,trigger(){this.do()},onApply:j,onFinished:C})}}function O(e,t){return t}function A(e){return e}new E({update(e,t,...s){t.call(this,...s)}});let P=[function(e,t,...s){let i=t.call(this,...s);return i&&i.info&&i.info.unshift(t),i},0,j,C],L={Enters:new z("mouseEntered",["mouse/presets/entered"],["mouse/over"],O,...P),Leaves:new z("mouseLeft",["mouse/presets/left"],["mouse/over"],A,...P),Left:M("left"),Right:M("right"),Middle:M("middle")};var N=Object.freeze({__proto__:null,mouse:L}),H=Object.freeze({__proto__:null,effect:class{node;constructor(e,t,s,i,n){this.node=new E(e,t,s,i,n),this.Name=this.node.Name,this.tags=this.node.tags,this.type=this.node.type}onApply(e=1,...t){e*=60;let s=this.currentNode.node.node.onApply.call(this,...t);return s?(s.info||(s.info=[]),s.info=[e,...s.info],s):{info:[e,...t]}}update(e,t,...s){if(t<=0)return void this.remove();t-=e;let i=this.currentNode.node.node.update.call(this,e,...s);return i?(i.info||(i.info=[]),i.info=[t,...i.info],i):{info:[t,...s]}}onFinished(e,...t){let s=this.currentNode.node.node.onFinished.call(this,...t);if(s)return s.info||(s.info=[]),s.info=[e,...s.info],s}}});let I=w,S={arc:[new I({path:["renderer/radius"],tags:["arc"],trigger:function([e,t]){this.system_set("hitbox/radius",t)},onApply:function(){this.set("hitbox/radius",this.system_get(["renderer","radius"]))}})],box:[new I({path:["renderer/width"],tags:["box"],trigger:function([e,t]){this.set("hitbox/width",t)},onApply:function(){this.set("hitbox/width",this.system_get(["renderer","width"]))}}),new I({path:["renderer/height"],tags:["box"],trigger:function([e,t]){this.set("hitbox/height",t)},onApply:function(){this.set("hitbox/height",this.system_get(["renderer","height"]))}})],txt:[new I({path:["renderer/string"],tags:["txt"],trigger:function([e,t]){let s=this.system_get(["renderer"]),i=r.measureText(t,s);this.set("hitbox/width",i),this.set("hitbox/height",s.fontsize)},onApply:function(){let e=this.system_get(["renderer"]),t=r.measureText(e.string,e);this.set("hitbox/width",t),this.set("hitbox/height",e.fontsize)}})]},F=[new I({path:["renderer/rotation"],trigger:function([e,t]){this.set("hitbox/rotation",t)},onApply:function(){this.set("hitbox/rotation",this.system_get(["renderer","rotation"]))}}),new I({path:["renderer/x"],trigger:function([e,t]){this.set("hitbox/x",t)},onApply:function(){this.set("hitbox/x",this.system_get(["renderer","x"]))}}),new I({path:["renderer/y"],trigger:function([e,t]){this.set("hitbox/y",t)},onApply:function(){this.set("hitbox/y",this.system_get(["renderer","y"]))}})],U=[new I({path:["renderer/type"],tags:["linkHitboxToRenderer"],trigger:function([e,t]){this.set("hitbox/type",t),this.remove(...this.anyNodeByTag(e)),this.add(...S[t])},onApply:function(){let e=this.system_get(["renderer","type"]);this.set("hitbox/type",e),this.add(...F),this.add(...S[e])}})];var B=Object.freeze({__proto__:null,linkHitboxToRenderer:U});class K{#s={fired:function(){},signal:"script"};constructor(e){Object.assign(this,this.#s,e,{type:"script"})}}const R=m.system_signal_converter,W={path:"properties/x",fired(){},on_insert(){},on_removal(){},detect:"set"};var q=Object.freeze({__proto__:null,event:class extends K{constructor(e="properties/x",t=function(){},s=function(){},i=function(){},n="set"){let r,o,a={};"object"==typeof e?({path:r,detect:o,...a}={...W,...e}):(r=e,o=n,a={fired:t,on_insert:s,on_removal:i,event_node:!0}),super({...a,signal:R(r,o)})}}});const X={fired_function(){},on_insert_function(){},on_removal_function(){},detect:"update"},Y={...q,...Object.freeze({__proto__:null,frame:class extends K{constructor(e=function(){},t=function(){},s=function(){},i="update"){let n,r;"object"==typeof e?({detect:n,...r}={...X,...e}):(n=i,r={fired:e,on_insert:t,on_removal:s,detect:i}),super({...r,signal:`-u$${n[0]}`})}}})};let G={...D,...N,...H,...B,...Object.freeze({__proto__:null,scripts:Y})},J=new class{idList={};Canvas=new e;canvas=this.Canvas.canvas;ctx=this.Canvas.ctx;time=0;eventNode=w;node=E;presets=G;utils=r;script=K;mouse={x:0,y:0,filteredX:0,filteredY:0,isover:!1};scenes={};allElements={};window={width:window.innerWidth,height:window.innerHeight};constructor(){let e=this;this.element=class extends v{constructor(t,s,i,...n){super(t,s,i,...n),e.addElement(this)}},this.entity=class extends x{constructor(t,s,i,...n){super(t,s,i,...n),e.addElement(this)}}}generateId=function(e=28){let t="";for(let s=0;s<e-4;s++)t+="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890-=+_|!@#$%^&*()<>".charAt(Math.floor(79*Math.random()));this.idList[t]&&(t=this.generateId(e));let s=Math.floor(Math.random()*(t.length+1));return t=t.slice(0,s)+"gen-"+t.slice(s),this.idList[t]=!0,t};begin(){this.events=new o(this),this.addScene("Main"),c()}addScene(e){this.currentscene=new l(e),this.scenes[e]=this.currentscene}callScene(e){this.scenes[e]&&(this.currentscene=this.scenes[e])}addElement(e){this.allElements[e.id]=e,this.currentscene.addElement(e)}removeElement(e){delete this.allElements[e.id],this.currentscene.removeElement(e)}};J.begin();export{J as game};
//# sourceMappingURL=engine.min.js.map
